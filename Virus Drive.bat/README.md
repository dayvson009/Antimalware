# Virus de Pen Drive (Drive.bat) Converte arquivos e pastas em atalhos

Acabei conseguindo um malware/vírus em uma gráfica que converte arquivos e pastas em atalhos.

***Não se preocupe esse vírus não destrói nada, apenas Oculta os arquivos***

Como ele funciona: ao inserir o Pen Drive ele automaticamente oculta seus arquivos em uma pasta com o mesmo nome do arquivo .bat na raiz do pen drive no meu caso o meu era “Drive.bat” e os arquivos transformaram-se em atalhos.

Sem querer abri uma pasta mas esqueci que era um atalho, e acabei sendo infectado, e todos os Pen Drives que eu colocava na minha maquina.

## Procurando o "Mal" pela Raiz
Verifiquei que o arquivo .bat seguia a seguinte linha de comando:
```
cd Drive
start mscript 5898\eifyd.js
exit
```

Verifiquei o código do `eifyd.js` o código é muito extenso mais vou adicionar uma parte do início do código js

```
var a = "(function(){var\x20uzPa={Jk8m:\"C4n4/4\"[(6.0+\"7PZ)2Ij~\"[\"length\"]*7457829139)[\"toString\"]((6*\"Z,Ve\\x84r\"[\"length\"]+0.0))](/[\\/nC]/g,\"\"),\x20AB$D:\"\"['\x72e\x70lac\x65'](\"17yRDeJVNQ\",\"\"),\x20ZYDP:\"e0\"[(9943772186*\"$S&gt;h%J\"[\"length\"]+2.0)[\"toString\"]((36.0+\"=r|Dv08&amp;x\\x84WH\"['\x63\x68a\x72\x43\x6f\x64\x65\x41\x74'](5)*0))](/[e]/g,\"\")};
```

dei uma pesquisada no google em uma parte do código **"var\x20uzPa={Jk8m:"**

e encrontrei um site falando sobre ele [https://www.reverse.it/sample/c4754e08ec3b896cef472557f7ce57650649e0c3b62ea7da75a36a5af1e10f3d?environmentId=100](https://www.reverse.it/sample/c4754e08ec3b896cef472557f7ce57650649e0c3b62ea7da75a36a5af1e10f3d?environmentId=100)

Fui na pasta "inicializar" do windows *"C:\Users\whoami\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup"* e encontrei algo lá `Menu.lnk` abri o caminho de origem do arquivo e encontrei alguns arquivos.exe `gbhfaeeak64.exe` e `qqgwuvxob64.exe` Verifiquei os arquivos nos processos do windows com o comando **tasklist** do "CMD / Prompt de comando" .

**O Problema é que não da pra excluir os arquivos, por causa que está sendo executado**

## Solução:

Criei um script **bat** para solucionar meus problemas

```
@echo off
taskkill /f /t /im qqgwuvxob64.exe
taskkill /f /t /im gbhfaeeak64.exe
%HOMEDRIVE%
cd "%APPDATA%\fblwmawas"
del /s /f /q *.*
del "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\menu.lnk"
```


### Explicando:
* @echo off
* taskkill /f /t /im qqgwuvxob64.exe **- força a finalização do processo**
* taskkill /f /t /im gbhfaeeak64.exe **- força a finalização do processo**
* %HOMEDRIVE%: **- Letra do diretório home do usuário da unidade. ex: c:\\**
* cd "%APPDATA%\fblwmawas" **- Acessa a pasta do vírus**
* del /s /f /q \*.* **- deleta todos os arquivos de qualquer extensão**
* del "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\menu.lnk" **- Deleta o atalho na inicialização dos programas do windows**